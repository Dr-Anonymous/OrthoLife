import{x as y,r as d,m as S,j as e,B as b,w as _}from"./index-DYCdECr2.js";import{H as T,F as k}from"./Footer-5CF68671.js";import{B as C}from"./badge-zPQ83eSx.js";import{s as w}from"./client-opfxi3BE.js";import{S as o}from"./skeleton-DeYKIxXw.js";import{u as E,L}from"./LanguageSwitcher-KF_GyB1b.js";import{N as P,S as $}from"./NextSteps-O20xOIJD.js";import{U as B}from"./user-B71ZlHy8.js";import{C as q}from"./calendar-B3ZTj5yV.js";import{C as A}from"./clock-9TRYkq0J.js";import{A as D}from"./arrow-left-Cz_S64QH.js";import"./index-DOA-4b-m.js";import"./phone-DAWZ9XqU.js";import"./card-B7__9nPQ.js";const X=()=>{const{postId:u}=y(),{i18n:i}=E(),[t,p]=d.useState(null),[l,f]=d.useState(null),[m,g]=d.useState(!0),{toast:j}=S(),N=async()=>{const a=`${window.location.origin}${window.location.pathname}`,r=i.language&&i.language!=="en"?`${a}?lang=${i.language}`:a,s={title:l?.title||t.title,text:`Check out this article from OrthoLife: ${l?.title||t.title}`,url:r};try{navigator.share&&t?await navigator.share(s):(await navigator.clipboard.writeText(r),j({title:"Link Copied!",description:"The article link has been copied to your clipboard."}))}catch(x){console.error("Failed to share:",x),j({title:"Error",description:"Could not share the article.",variant:"destructive"})}},v=(a,r=160)=>{const s=a.replace(/<[^>]*>/g,"");return s.length>r?s.substring(0,r).trim()+"...":s},n=(a,r)=>{let s=document.querySelector(`meta[name="${a}"]`);s||(s=document.createElement("meta"),s.name=a,document.head.appendChild(s)),s.content=r},c=(a,r)=>{let s=document.querySelector(`meta[property="${a}"]`);s||(s=document.createElement("meta"),s.setAttribute("property",a),document.head.appendChild(s)),s.content=r};return d.useEffect(()=>{(async()=>{if(u){g(!0),f(null);try{const{data:r,error:s}=await w.from("posts").select("*, categories(name)").eq("id",u).single();if(s)throw s;if(p(r),i.language!=="en"){const{data:x,error:h}=await w.from("post_translations").select("*").eq("post_id",u).eq("language",i.language).single();if(h&&h.code!=="PGRST116")throw h;x&&f(x)}}catch(r){console.error("Error fetching post data:",r),p(null)}finally{g(!1)}}})()},[u,i.language]),d.useEffect(()=>{if(t){document.title=`${t.title} | OrthoLife`;const a=t.excerpt||v(t.content);n("description",a),c("og:title",t.title),c("og:description",a),c("og:image",t.image_url),c("og:type","article"),n("twitter:card","summary_large_image"),n("twitter:title",t.title),n("twitter:description",a),n("twitter:image",t.image_url),c("article:author",t.author),c("article:published_time",t.created_at)}else m||(document.title="Post Not Found | OrthoLife",n("description","The requested blog post could not be found."));return()=>{document.title="OrthoLife"}},[t,m]),e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(T,{}),e.jsx("main",{className:"flex-grow bg-muted/50 pt-20",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[m&&e.jsxs("div",{children:[e.jsx(o,{className:"h-10 w-3/4 mb-4"}),e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx(o,{className:"h-5 w-24"}),e.jsx(o,{className:"h-5 w-24"}),e.jsx(o,{className:"h-5 w-24"})]}),e.jsx(o,{className:"h-96 w-full mb-8"}),e.jsx(o,{className:"h-4 w-full mb-2"}),e.jsx(o,{className:"h-4 w-full mb-2"}),e.jsx(o,{className:"h-4 w-5/6"})]}),!m&&t&&e.jsxs("article",{className:"pb-24",children:[e.jsxs("header",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(C,{children:t.categories.name}),e.jsx(L,{})]}),e.jsx("h1",{className:"text-4xl font-heading font-bold text-primary mb-4",children:l?.title||t.title}),e.jsxs("div",{className:"flex items-center text-muted-foreground flex-wrap",children:[e.jsxs("div",{className:"flex items-center mr-6 mb-2",children:[e.jsx(B,{size:16,className:"mr-2"}),e.jsx("span",{children:t.author})]}),e.jsxs("div",{className:"flex items-center mr-6 mb-2",children:[e.jsx(q,{size:16,className:"mr-2"}),e.jsx("span",{children:new Date(t.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(A,{size:16,className:"mr-2"}),e.jsxs("span",{children:[t.read_time_minutes," min read"]})]})]})]}),e.jsx("img",{src:t.image_url,alt:l?.title||t.title,className:"w-full h-auto rounded-lg mb-8",loading:"lazy"}),e.jsx("div",{className:"prose prose-lg max-w-none",dangerouslySetInnerHTML:{__html:l?.content||t.content}}),e.jsx(P,{nextStepsContent:l?.next_steps||t.next_steps}),e.jsx("div",{className:"sticky bottom-0 p-4 border-t z-10 bg-background/20 backdrop-blur-sm",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(b,{asChild:!0,variant:"outline",children:e.jsxs(_,{to:"/blog",children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),"Back to Blog"]})}),e.jsxs(b,{onClick:N,children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Share Article"]})]})})]}),!m&&!t&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Post not found"}),e.jsx("p",{className:"text-muted-foreground",children:"The blog post you are looking for does not exist."})]})]})})}),e.jsx(k,{})]})};export{X as default};
