import{r as m,j as e,B as N}from"./index-DYCdECr2.js";import{u as R,F as q,a,b as t,c as n,d as l,e as c,R as p,t as B,o as I,s as i,f as L}from"./RichTextEditor-SEif6zb0.js";import{I as x}from"./input-BlRor6HD.js";import{T as C}from"./textarea-CrPgbkNX.js";import{T as V,a as w,b as y,c as E}from"./tabs-C7V-UyVv.js";import{s as P}from"./client-opfxi3BE.js";const k=I({title:i().min(1,"Title is required"),excerpt:i().min(1,"Excerpt is required"),content:i().min(1,"Content is required"),author:i().min(1,"Author is required"),image_url:i().url("Please enter a valid URL"),read_time_minutes:L.number().int().positive("Must be a positive number"),category_name:i().min(1,"Category is required"),next_steps:i().optional()}),J=({initialData:j,translations:g,onSubmit:v,isSubmitting:T})=>{const[F,_]=m.useState([]),[d,f]=m.useState({}),r=R({resolver:B(k),defaultValues:j||{}});m.useEffect(()=>{(async()=>{const{data:o,error:u}=await P.from("categories").select("*");u?console.error("Error fetching categories:",u):_(o||[])})()},[]),m.useEffect(()=>{j&&r.reset(j),g&&f(g)},[j,g,r]);const h=(s,o,u)=>{f(b=>({...b,[s]:{...b[s],[o]:u}}))},S=s=>{v(s,d)};return e.jsx(q,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(S),className:"space-y-8",children:[e.jsxs(V,{defaultValue:"english",className:"w-full",children:[e.jsxs(w,{className:"grid w-full grid-cols-2 sticky top-16 z-20 bg-background",children:[e.jsx(y,{value:"english",children:"English"}),e.jsx(y,{value:"telugu",children:"Telugu"})]}),e.jsxs(E,{value:"english",className:"space-y-8 pt-4",children:[e.jsx(a,{control:r.control,name:"title",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Title"}),e.jsx(l,{children:e.jsx(x,{placeholder:"Enter post title",...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"excerpt",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Excerpt"}),e.jsx(l,{children:e.jsx(C,{placeholder:"Enter a short excerpt",...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"content",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Content"}),e.jsx(l,{children:e.jsx(p,{content:s.value||"",onChange:o=>{o==="<p></p>"?s.onChange(""):s.onChange(o)}})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"next_steps",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Next Steps"}),e.jsx(l,{children:e.jsx(p,{content:s.value||"",onChange:s.onChange})}),e.jsx(c,{})]})})]}),e.jsxs(E,{value:"telugu",className:"space-y-8 pt-4",children:[e.jsxs(t,{children:[e.jsx(n,{children:"Translated Title (Telugu)"}),e.jsx(l,{children:e.jsx(x,{placeholder:"Enter Telugu title",value:d.te?.title||"",onChange:s=>h("te","title",s.target.value)})})]}),e.jsxs(t,{children:[e.jsx(n,{children:"Translated Excerpt (Telugu)"}),e.jsx(l,{children:e.jsx(C,{placeholder:"Enter Telugu excerpt",value:d.te?.excerpt||"",onChange:s=>h("te","excerpt",s.target.value)})})]}),e.jsxs(t,{children:[e.jsx(n,{children:"Translated Content (Telugu)"}),e.jsx(l,{children:e.jsx(p,{content:d.te?.content||"",onChange:s=>h("te","content",s)})})]}),e.jsxs(t,{children:[e.jsx(n,{children:"Translated Next Steps (Telugu)"}),e.jsx(l,{children:e.jsx(p,{content:d.te?.next_steps||"",onChange:s=>{s==="<p></p>"?h("te","next_steps",""):h("te","next_steps",s)}})})]})]})]}),e.jsxs("div",{className:"space-y-8 pt-8 border-t",children:[e.jsx(a,{control:r.control,name:"author",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Author"}),e.jsx(l,{children:e.jsx(x,{placeholder:"Enter author's name",...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"image_url",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Image URL"}),e.jsx(l,{children:e.jsx(x,{placeholder:"https://example.com/image.jpg",...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"read_time_minutes",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Read Time (minutes)"}),e.jsx(l,{children:e.jsx(x,{type:"number",placeholder:"e.g., 5",...s})}),e.jsx(c,{})]})}),e.jsx(a,{control:r.control,name:"category_name",render:({field:s})=>e.jsxs(t,{children:[e.jsx(n,{children:"Category"}),e.jsx(l,{children:e.jsxs(e.Fragment,{children:[e.jsx(x,{list:"category-suggestions",placeholder:"Select or create a category",...s}),e.jsx("datalist",{id:"category-suggestions",children:F.map(o=>e.jsx("option",{value:o.name},o.id))})]})}),e.jsx(c,{})]})})]}),e.jsx(N,{type:"submit",disabled:T,children:T?"Submitting...":"Submit Post"})]})})};export{J as B};
