import{x as y,r as l,m as k,j as e,B as u,w as D}from"./index-DYCdECr2.js";import{H as G,F as T}from"./Footer-5CF68671.js";import{B as C}from"./badge-zPQ83eSx.js";import{s as N}from"./client-opfxi3BE.js";import{u as _,L}from"./LanguageSwitcher-KF_GyB1b.js";import{B as P,g as B}from"./pdfUtils-DRQF1C1g.js";import{S as r}from"./skeleton-DeYKIxXw.js";import{N as E,S as z}from"./NextSteps-O20xOIJD.js";import{C as F}from"./clock-9TRYkq0J.js";import{A as $}from"./arrow-left-Cz_S64QH.js";import{D as q}from"./download-DEPQl7YA.js";import"./index-DOA-4b-m.js";import"./phone-DAWZ9XqU.js";import"./card-B7__9nPQ.js";const Z=()=>{const{guideId:o}=y(),{t:b,i18n:i}=_(),[s,h]=l.useState(null),[t,g]=l.useState(null),[m,f]=l.useState(!0),[p,j]=l.useState(!1),{toast:w}=k(),v=async()=>{if(!s)return;j(!0);const n=t?.content||s.content,a=t?.title||s.title;await B(n,a),j(!1)};l.useEffect(()=>{(async()=>{if(o){f(!0),g(null);try{const{data:a,error:c}=await N.from("guides").select("*, categories(name)").eq("id",o).single();if(c)throw c;h(a);const{data:d,error:x}=await N.from("guide_translations").select("*").eq("guide_id",o).eq("language",i.language).single();if(x&&x.code!=="PGRST116")throw x;d&&g(d)}catch(a){console.error("Error fetching guide:",a),h(null)}finally{f(!1)}}})()},[o,i.language]);const S=async()=>{const n=`${window.location.origin}${window.location.pathname}`,a=i.language&&i.language!=="en"?`${n}?lang=${i.language}`:n,c={title:t?.title||s.title,text:`Check out this patient guide from OrthoLife: ${t?.title||s.title}`,url:a};try{navigator.share&&s?await navigator.share(c):(await navigator.clipboard.writeText(a),w({title:"Link Copied!",description:"The guide link has been copied to your clipboard."}))}catch(d){console.error("Failed to share:",d),w({title:"Error",description:"Could not share the guide.",variant:"destructive"})}};return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(G,{}),e.jsx("main",{className:"flex-grow bg-muted/50 pt-20",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[m&&e.jsxs("div",{children:[e.jsx(r,{className:"h-10 w-3/4 mb-4"}),e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx(r,{className:"h-5 w-24"}),e.jsx(r,{className:"h-5 w-24"})]}),e.jsx(r,{className:"h-96 w-full mb-8"}),e.jsx(r,{className:"h-4 w-full mb-2"}),e.jsx(r,{className:"h-4 w-full mb-2"}),e.jsx(r,{className:"h-4 w-5/6"})]}),!m&&s&&e.jsxs("article",{className:"pb-24",children:[e.jsxs("header",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(C,{children:s.categories.name}),e.jsx(L,{})]}),e.jsx("h1",{className:"text-4xl font-heading font-bold text-primary mb-4",children:t?.title||s.title}),e.jsxs("div",{className:"flex items-center text-muted-foreground flex-wrap",children:[e.jsxs("div",{className:"flex items-center mr-6 mb-2",children:[e.jsx(P,{size:16,className:"mr-2"}),e.jsxs("span",{children:[s.pages," pages"]})]}),e.jsxs("div",{className:"flex items-center mr-6 mb-2",children:[e.jsx(F,{size:16,className:"mr-2"}),e.jsx("span",{children:s.estimated_time})]})]})]}),e.jsx("img",{src:s.cover_image_url,alt:t?.title||s.title,className:"w-full h-auto rounded-lg mb-8",loading:"lazy"}),e.jsx("div",{className:"prose prose-lg max-w-none",dangerouslySetInnerHTML:{__html:t?.content||s.content}}),e.jsx(E,{nextStepsContent:t?.next_steps||s.next_steps}),e.jsx("div",{className:"sticky bottom-0 p-4 border-t z-10 bg-background/20 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[e.jsx(u,{asChild:!0,variant:"outline",children:e.jsxs(D,{to:"/guides",children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Back to Guides"]})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(u,{onClick:S,children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Share Guide"]}),e.jsx(u,{variant:"outline",className:"flex items-center gap-2",onClick:v,disabled:p,children:p?"Downloading...":e.jsxs(e.Fragment,{children:[e.jsx(q,{size:16}),b("guides.downloadPdf","Download PDF")]})})]})]})})]}),!m&&!s&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"Guide not found"}),e.jsx("p",{className:"text-muted-foreground",children:"The patient guide you are looking for does not exist."})]})]})})}),e.jsx(T,{})]})};export{Z as default};
